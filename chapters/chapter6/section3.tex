\section{هر بخش از فایل PE چه مزایایی دارد و چه اطلاعاتی را در خود ذخیره می‌کند؟}

فایل‌های اجرایی در سیستم‌عامل ویندوز با قالب \lr{PE (Portable Executable)} شناخته می‌شوند. این قالب، ساختار استاندارد تمام فایل‌های اجرایی مانند ‎\lr{.exe}‎، ‎\lr{.dll}‎، ‎\lr{.sys}‎ و بسیاری از فایل‌های سیستم است. هدف از طراحی قالب PE ایجاد یک چارچوب قابل‌حمل میان نسخه‌های مختلف ویندوز است تا سیستم‌عامل بتواند برنامه‌ها را به‌صورت بهینه در حافظه بارگذاری، مدیریت و اجرا کند. 

ساختار فایل PE از چندین بخش اصلی تشکیل شده است که هر کدام وظیفه‌ی خاصی دارند. این بخش‌ها اطلاعات ضروری مانند کد اجرایی، داده‌ها، منابع و تنظیمات بارگذاری را ذخیره می‌کنند. در ادامه، هر بخش فایل PE به همراه وظایف، مزایا و نوع اطلاعات ذخیره‌شده در آن توضیح داده می‌شود.  

\subsection{۳-۶-۱- بخش Header (هدر فایل PE)}
هدر فایل PE در ابتدای فایل قرار دارد و شامل اطلاعات کلی درباره‌ی ساختار، نسخه و نحوه‌ی بارگذاری برنامه در حافظه است. این بخش به سیستم‌عامل کمک می‌کند تا بداند فایل چگونه باید تفسیر و اجرا شود.  

\textbf{زیرمجموعه‌های مهم هدر PE عبارت‌اند از:}
\begin{itemize}
    \item \textbf{DOS Header:} برای سازگاری با نسخه‌های قدیمی DOS استفاده می‌شود. اگر برنامه در محیط DOS اجرا شود، پیامی مانند \lr{"This program cannot be run in DOS mode"} نمایش داده می‌شود. مزیت آن \textbf{سازگاری عقب‌رو (Backward Compatibility)} است.
    \item \textbf{PE Signature:} رشته‌ای با مقدار \lr{"PE\textbackslash0\textbackslash0"} که آغاز ساختار واقعی PE را مشخص می‌کند.
    \item \textbf{File Header:} حاوی اطلاعات عمومی مانند نوع فایل (exe یا dll)، تعداد بخش‌ها، تاریخ ساخت و اندازه‌ی داده‌ها است.
    \item \textbf{Optional Header:} شامل اطلاعات حیاتی برای بارگذاری در حافظه مانند آدرس نقطه‌ی ورود (\lr{Entry Point})، اندازه‌ی پشته و نوع پردازنده است.
\end{itemize}

\textbf{مزایا:}
\begin{itemize}
    \item فراهم‌کردن نقشه‌ی دقیق ساختار فایل برای Loader
    \item افزایش سازگاری با نسخه‌های مختلف ویندوز
    \item بهینه‌سازی فرآیند بارگذاری و تخصیص حافظه
\end{itemize}

\subsection{۳-۶-۲- بخش \lr{.text}}
بخش \lr{.text} شامل \textbf{کدهای اجرایی برنامه} (دستورالعمل‌های ماشین) است. این قسمت معمولاً به‌صورت فقط‌خواندنی در حافظه نگهداری می‌شود تا از تغییرات ناخواسته جلوگیری شود.  

\textbf{اطلاعات موجود در این بخش:}
\begin{itemize}
    \item دستورالعمل‌های کامپایل‌شده
    \item آدرس و محل قرارگیری توابع
    \item داده‌های ثابت و ثابت‌های برنامه
\end{itemize}

\textbf{مزایا:}
\begin{itemize}
    \item افزایش امنیت از طریق جلوگیری از تغییر کدها در زمان اجرا
    \item صرفه‌جویی در حافظه به دلیل امکان اشتراک کد بین چند فرآیند
    \item تسهیل فرآیند اشکال‌زدایی (\lr{Debugging})
\end{itemize}

\subsection{۳-۶-۳- بخش \lr{.data}}
این بخش شامل \textbf{داده‌های مقداردهی‌شده (Initialized Data)} است؛ یعنی متغیرهایی که در زمان کامپایل مقدار اولیه دارند. برای مثال، در زبان C اگر دستور \lr{int a = 10;} وجود داشته باشد، مقدار آن در این بخش ذخیره می‌شود.  

\textbf{مزایا:}
\begin{itemize}
    \item فراهم‌کردن دسترسی سریع به داده‌های مهم در زمان اجرا
    \item حفظ داده‌های پایدار در طول اجرای برنامه
    \item ساختاردهی مناسب حافظه و جلوگیری از تداخل متغیرها
\end{itemize}

\subsection{۳-۶-۴- بخش \lr{.bss}}
بخش \lr{.bss} برای \textbf{داده‌های بدون مقدار اولیه (Uninitialized Data)} استفاده می‌شود. این داده‌ها در زمان بارگذاری برنامه به‌صورت خودکار با مقدار صفر مقداردهی می‌شوند.  

\textbf{نمونه:} در برنامه‌ای با دستور \lr{int counter;}، متغیر \lr{counter} در بخش \lr{.bss} قرار می‌گیرد.  

\textbf{مزایا:}
\begin{itemize}
    \item کاهش اندازه‌ی فایل اجرایی چون داده‌های بدون مقدار ذخیره نمی‌شوند
    \item تخصیص پویا و بهینه‌ی حافظه در زمان اجرا
    \item تفکیک واضح میان داده‌های مقداردهی‌شده و نشده
\end{itemize}

\subsection{۳-۶-۵- بخش \lr{.rdata}}
بخش \lr{.rdata} شامل \textbf{داده‌های فقط‌خواندنی (Read-Only Data)} است؛ مانند رشته‌های ثابت، جداول واردات و صادرات و برخی ساختارهای زمان اجرا.  

\textbf{اطلاعات ذخیره‌شده در این بخش:}
\begin{itemize}
    \item نام توابع و کتابخانه‌های وارداتی
    \item داده‌های ثابت و اشاره‌گرهای ثابت
    \item اطلاعات لازم برای زمان اجرا
\end{itemize}

\textbf{مزایا:}
\begin{itemize}
    \item جلوگیری از تغییر داده‌های حیاتی در حین اجرا
    \item بهبود امنیت و پایداری برنامه
    \item افزایش کارایی حافظه با امکان اشتراک داده‌ها میان چند فرآیند
\end{itemize}

\subsection{۳-۶-۶- بخش \lr{.idata}}
این بخش مربوط به \textbf{جدول واردات (Import Table)} است و فهرستی از کتابخانه‌ها و توابع خارجی که برنامه از آن‌ها استفاده می‌کند را ذخیره می‌کند.  

\textbf{مزایا:}
\begin{itemize}
    \item تسهیل در مدیریت وابستگی‌های خارجی
    \item پشتیبانی از بارگذاری پویا (\lr{Dynamic Linking})
    \item امکان به‌روزرسانی کتابخانه‌ها بدون نیاز به تغییر برنامه‌ی اصلی
\end{itemize}

\subsection{۳-۶-۷- بخش \lr{.edata}}
بخش \lr{.edata} مربوط به \textbf{جدول صادرات (Export Table)} است. این جدول فهرستی از توابع یا داده‌هایی را نگهداری می‌کند که برنامه برای استفاده‌ی سایر برنامه‌ها در دسترس قرار می‌دهد.  

\textbf{مزایا:}
\begin{itemize}
    \item امکان اشتراک توابع و داده‌ها بین چند برنامه
    \item پشتیبانی از ساختار ماژولار نرم‌افزار
    \item کاهش حجم کد تکراری در سیستم
\end{itemize}

\subsection{۳-۶-۸- بخش \lr{.rsrc}}
بخش \lr{.rsrc} محل ذخیره‌ی \textbf{منابع (Resources)} مانند آیکون‌ها، منوها، تصاویر، فایل‌های زبان و داده‌های رابط کاربری است. این بخش به برنامه اجازه می‌دهد بدون تغییر در کد، ظاهر و محتوای خود را به‌روزرسانی کند.  

\textbf{اطلاعات موجود در این بخش:}
\begin{itemize}
    \item آیکون‌ها، تصاویر و صداها
    \item اطلاعات نسخه‌ی نرم‌افزار
    \item داده‌های مربوط به زبان و محلی‌سازی (\lr{Localization})
\end{itemize}

\textbf{مزایا:}
\begin{itemize}
    \item جدا کردن منابع از منطق اصلی برنامه
    \item تسهیل در تغییر ظاهر یا زبان نرم‌افزار
    \item پشتیبانی از چندزبانگی در نرم‌افزارهای بزرگ
\end{itemize}

\subsection{۳-۶-۹- بخش \lr{.reloc}}
بخش \lr{.reloc} برای \textbf{اطلاعات جابجایی (Relocation Information)} استفاده می‌شود. زمانی‌که فایل PE در آدرس مجازی پیش‌فرض خود بارگذاری نشود، این بخش به سیستم‌عامل کمک می‌کند تا آدرس‌های مطلق را اصلاح کند.  

\textbf{مزایا:}
\begin{itemize}
    \item پشتیبانی از بارگذاری انعطاف‌پذیر در حافظه
    \item جلوگیری از تداخل آدرس‌ها بین چند ماژول
    \item بهبود قابلیت استفاده‌ی مجدد از کدها در محیط‌های مختلف
\end{itemize}

\subsection{۳-۶-۱۰- جمع‌بندی}
هر بخش از فایل PE نقشی مشخص و حیاتی در عملکرد صحیح برنامه دارد. این تقسیم‌بندی باعث می‌شود سیستم‌عامل بتواند برنامه‌ها را سریع‌تر، ایمن‌تر و با مدیریت بهینه‌ی حافظه اجرا کند.  

از بخش هدر که نقشه‌ی کلی فایل را در اختیار Loader قرار می‌دهد تا بخش‌های کد و داده که منطق برنامه را تشکیل می‌دهند، و همچنین بخش منابع که داده‌های ظاهری و رابط کاربری را ذخیره می‌کند، همگی در کنار هم ساختار منظم و کارآمدی برای اجرای برنامه‌ها در ویندوز ایجاد می‌کنند.  

به‌طور کلی، مزیت اصلی ساختار PE در \textbf{قابلیت حمل، انعطاف‌پذیری، امنیت و ماژولار بودن} آن است؛ ویژگی‌هایی که باعث شده این قالب طی سال‌ها همچنان استاندارد اصلی فایل‌های اجرایی در ویندوز باقی بماند.
