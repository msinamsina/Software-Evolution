\section{ابزارهای تجاری و غیرتجاری}

با توجه به اینکه چشم‌انداز تهدیدات سایبری روز به روز «پیچیده‌تر و خطرناک‌تر» می‌شود، نقش این ابزارها در تشریح، ممیزی، دیباگینگ و مقابله با تهدیدات، محوری و حیاتی است. آژانس امنیت ملی ایالات متحده (NSA) در توصیف چارچوب Ghidra، بر اهمیت این ابزارها در تحلیل کدهای مخرب و ایجاد بینش عمیق برای درک آسیب‌پذیری‌های بالقوه در شبکه‌ها و سیستم‌ها تأکید می‌کند. \cite{NSA-ghidra} در واقع، این ابزارها دیگر یک کنجکاوی آکادمیک نیستند، بلکه یک ضرورت استراتژیک در دفاع سایبری محسوب می‌شوند. مطالعه ابزارهای مختلف و امکان ترکیب آن‌ها برای بهره‌گیری از هم‌افزایی (\lr{Synergies}) جهت بهبود تشخیص آسیب‌پذیری، یک حوزه تحقیقاتی فعال است. \cite{ocs2020}

\subsection{طبقه‌بندی متدولوژیک ابزارها}

درک این اکوسیستم پیچیده، نیازمند یک طبقه‌بندی سه‌گانه بر اساس عملکرد اصلی و جایگاه تاریخی ابزارها است:

\begin{enumerate}
    \item \textbf{چارچوب‌های تحلیل جامع (\lr{SRE Frameworks}):}  این‌ها پلتفرم‌های یکپارچه‌ای هستند که اکوسیستم کاملی برای تحلیل استاتیک (بررسی کد بدون اجرا) و تحلیل دینامیک (بررسی کد در حین اجرا) ارائه می‌دهند. ابزارهای اصلی در این دسته شامل \textbf{IDA Pro}، \textbf{Ghidra}، \textbf{Binary Ninja} و \textbf{Radare2} می‌باشند. \cite{devopsschool2025} این چارچوب‌ها هسته اصلی تحقیقات مدرن SRE را تشکیل می‌دهند.6
    \item \textbf{دیباگرهای تخصصی (\lr{Specialist Debuggers}):} ابزارهایی که منحصراً بر تحلیل دینامیک (مشاهده برنامه در حین اجرا) تمرکز دارند، مانند \textbf{GDB}، \textbf{WinDbg} و \textbf{\lr{x64dbg}}.
    \item \textbf{ابزارهای میراث (\lr{Legacy Tools}):} ابزارهایی مانند \textbf{OllyDbg} که زمانی استاندارد صنعتی بودند اما اکنون توسعه آن‌ها متوقف شده و با جایگزین‌های مدرن تعویض شده‌اند.
\end{enumerate}

روند کلیدی در این اکوسیستم، «همگرایی» (Convergence) است. مرز بین تحلیل استاتیک و دینامیک در حال از بین رفتن است؛ چارچوب‌های استاتیک (مانند \lr{IDA}) دیباگرهای قدرتمندی اضافه کرده‌اند و دیباگرها (مانند \lr{x64dbg}) قابلیت‌های تحلیل استاتیک پایه را ارائه می‌دهند.

\subsection{بررسی چارچوب‌های جامع (\lr{SRE Frameworks})}

این پلتفرم‌ها راه‌حل‌های کاملی برای مهندسی معکوس ارائه می‌دهند.

\subsubsection{\lr{IDA Pro (Interactive Disassembler)}}
IDA Pro استاندارد تثبیت‌شده و تجاری صنعت برای تحلیل استاتیک است. شهرت آن به دلیل دیس‌اسمبلر فوق‌العاده قدرتمند با پشتیبانی از ده‌ها معماری و دکامپایلر پیشرو (و بسیار گران‌قیمت) \textbf{Hex-Rays} است. IDA همچنین شامل یک دیباگر چند پلتفرمی توانا است و از طریق \textbf{IDAPython} به شدت قابل توسعه می‌باشد. هزینه بسیار بالا، مانع اصلی ورود به آن است.  \cite{devopsschool2025}

\subsubsection{Ghidra}
Ghidra چارچوب SRE رایگان و متن‌بازی است که توسط NSA توسعه یافته و رقیب اصلی IDA محسوب می‌شود. بزرگترین مزیت آن، ارائه یک \textbf{دکامپایلر داخلی بسیار باکیفیت به‌صورت رایگان} برای تمام معماری‌های پشتیبانی‌شده است. Ghidra همچنین قابلیت‌های قوی برای تحلیل تیمی و همزمان (Collaboration) دارد. این ابزار مبتنی بر جاوا است که می‌تواند منجر به مصرف حافظه بالا و رابط کاربری کندتر نسبت به رقبای بومی (\lr{Native}) شود. \cite{NSA-ghidra}

\subsubsection{Binary Ninja}
Binary Ninja یک پلتفرم تجاری مدرن است که با تمرکز بر \textbf{رابط کاربری تمیز}، سرعت بالا و یک \textbf{API قدرتمند (\lr{API-First})} برای اتوماسیون خود را متمایز می‌کند. ستون فقرات آن، زبان میانی (\lr{BNIL}) است که نوشتن اسکریپت‌های تحلیلی پیچیده را آسان می‌کند. دکامپایلر باکیفیت آن در قیمت پایه (که از IDA ارزان‌تر است) گنجانده شده و APIهای آن در Python, C++ و Rust در دسترس هستند. \cite{devopsschool2025} \cite{binaryninja}

\subsubsection{\lr{Radare2 (R2)}}
R2 یک چارچوب مهندسی معکوس رایگان، متن‌باز و با رویکرد «اول خط فرمان» (\lr{CLI-first}) است. این ابزار به دلیل ماژولار بودن، قابلیت حمل فوق‌العاده (عالی برای IoT و موبایل) و قدرت خام، محبوب پژوهشگران پیشرفته است. R2 \textbf{منحنی یادگیری بسیار شیب‌داری} دارد، اما رابط گرافیکی \textbf{Cutter} استفاده از آن را آسان‌تر کرده است. R2 برای دکامپایل با کیفیت، به پلاگین‌های خارجی (مانند \texttt{r2ghidra} که از موتور Ghidra استفاده می‌کند) متکی است. \cite{devopsschool2025}

\subsection{دیباگرهای تخصصی: هنر تحلیل دینامیک}

این ابزارها بر تحلیل دینامیک و کنترل اجرای برنامه متمرکز هستند.

\subsubsection{\lr{GDB (The GNU Debugger)}}
GDB دیباگر استاندارد و قابل حمل در اکوسیستم‌های Unix-like (مانند Linux) است. این ابزار رایگان و متن‌باز، ستون فقرات دیباگینگ در این پلتفرم‌ها است و از طیف وسیعی از زبان‌ها و معماری‌ها (x86, ARM, MIPS, RISC-V) پشتیبانی می‌کند. قدرت اصلی آن در قابلیت \textbf{دیباگینگ از راه دور (\lr{Remote Debugging})} (حیاتی برای سیستم‌های نهفته) و اسکریپت‌پذیری (\lr{Python API}) است. رابط کاربری پیش‌فرض آن خط فرمان (CLI) است. \cite{wiki-gnu}

\subsubsection{\lr{WinDbg (Windows Debugger)}}
WinDbg ابزار رسمی و رایگان مایکروسافت برای دیباگینگ عمیق در ویندوز است. تخصص اصلی و غیرقابل جایگزین آن، \textbf{تحلیل سطح هسته (\lr{Kernel-mode})}، درایورها و تحلیل \textbf{crash dump} (فایل‌های \lr{BSOD}) است. قابلیت منحصربه‌فرد \textbf{\lr{Time Travel Debugging (TTD)}}، که امکان ضبط و اجرای معکوس اجرای برنامه را می‌دهد، آن را برای یافتن باگ‌های پیچیده بی‌نظیر می‌سازد. منحنی یادگیری آن بسیار شیب‌دار است. \cite{windbg2025}

\subsubsection{\lr{x64dbg}}
\lr{x64dbg} جایگزین مدرن، رایگان و متن‌باز برای OllyDbg است. این ابزار بر دیباگینگ \textbf{user-mode} برنامه‌های ۳۲ بیتی (\lr{x86}) و ۶۴ بیتی (\lr{x64}) در \textbf{ویندوز} تمرکز دارد. به دلیل رابط کاربری آشنا (شبیه به IDA و OllyDbg) و توسعه فعال، به انتخاب اول بسیاری از مهندسان معکوس و تحلیلگران بدافزار برای تحلیل دینامیک در ویندوز تبدیل شده است. \cite{devopsschool2025}

\subsubsection{\lr{OllyDbg} (میراث)}
OllyDbg برای سال‌ها استاندارد طلایی دیباگینگ user-mode 32 بیتی در ویندوز بود. توسعه این ابزار متوقف شده و به دلیل \textbf{عدم پشتیبانی از ۶۴ بیت}، کاملاً منسوخ تلقی می‌شود. این ابزار به طور کامل توسط \lr{x64dbg} جایگزین شده است. \cite{devopsschool2025}

\subsection{تحلیل مقایسه‌ای و جمع‌بندی}

انتخاب ابزار مناسب به سناریوی مورد استفاده، بودجه و ترجیح کاربر (GUI vs CLI) بستگی دارد.

\subsubsection{جدول مقایسه جامع}
جدول \ref{tab:tool_comparison} یک نمای کلی و مقایسه‌ای از ویژگی‌های کلیدی، هزینه‌ها و موارد استفاده ابزارهای مورد بحث ارائه می‌دهد.

% استفاده از sidewaystable برای نمایش افقی جدول در یک صفحه جداگانه
\begin{sidewaystable}[htp]
    \centering
    \scriptsize % استفاده از فونت کوچک‌تر برای جا شدن جدول
    \begin{tabularx}{\textwidth}{|l|X|X|X|X|X|X|X|X|}
        \hline
        \textbf{ویژگی} & \textbf{IDA Pro} & \textbf{Ghidra} & \textbf{Binary Ninja} & \textbf{Radare2 (w/ Cutter)} & \textbf{\lr{x64dbg}} & \textbf{WinDbg} & \textbf{GDB} & \textbf{OllyDbg (Legacy)} \\
        \hline
        \textbf{کارکرد اصلی} & چارچوب SRE & چارچوب SRE & چارچوب SRE & چارچوب SRE & دیباگر تخصصی & دیباگر تخصصی & دیباگر تخصصی & دیباگر تخصصی \\
        \hline
        \textbf{تحلیل اصلی} & استاتیک (قوی) / دینامیک & استاتیک (قوی) / دینامیک (با پل) & استاتیک (قوی) / دینامیک & استاتیک / دینامیک & دینامیک (قوی) / استاتیک (پایه) & دینامیک (بسیار قوی) & دینامیک (بسیار قوی) & دینامیک \\
        \hline
        \textbf{پلتفرم ابزار} & Win/Mac/Linux & Win/Mac/Linux (جاوا) & Win/Mac/Linux & Win/Mac/Linux/Mobile & فقط Windows & Windows & Unix-like (Win/Mac/Linux) & فقط Windows \\
        \hline
        \textbf{دیباگ کرنل؟} & بله (Remote) & خیر (از طریق پل GDB) & خیر & بله (Remote) & خیر & بله (تخصص اصلی) & بله (Remote) & خیر \\
        \hline
        \textbf{دکامپایلر؟} & بله (Hex-Rays، پولی) & بله (داخلی، رایگان) & بله (داخلی، در قیمت پایه) & بله (پلاگین r2ghidra) & خیر (پلاگین ضعیف) & خیر & خیر & خیر \\
        \hline
        \textbf{اسکریپت‌نویسی} & IDAPython, IDC, C++ & Java, Python (Jython) & Python, C++, Rust & r2pipe (چند زبانه) & زبان داخلی، C++ & JavaScript, NatVis & Python, Guile & پلاگین (C) \\
        \hline
        \textbf{هزینه و مجوز} & تجاری (بسیار گران) & رایگان (Apache 2.0) & تجاری (سطوح مختلف) & رایگان (LGPLv3) & رایگان (GPLv3) & رایگان (بخشی از SDK) & رایگان (GPL) & رایگان (Shareware) \\
        \hline
        \textbf{بهترین مورد استفاده} & تحلیل استاتیک عمیق & تحلیل استاتیک رایگان، همکاری & اتوماسیون API-first & هک و تحلیل CLI & دیباگ User-mode ویندوز & دیباگ کرنل ویندوز، TTD & دیباگ Unix/Linux & (میراث) دیباگ ۳۲ بیتی \\
        \hline
    \end{tabularx}
    \caption{جدول مقایسه جامع ابزارهای مهندسی معکوس و دیباگینگ}
    \label{tab:tool_comparison}
\end{sidewaystable}

\clearpage % بازگشت به حالت عمودی پس از جدول

\subsubsection{توصیه‌های سناریومحور}

انتخاب ابزار بهینه مستقیماً به وظیفه پیش رو بستگی دارد:

\begin{itemize}
    \item \textbf{سناریو ۱: تحلیل بدافزار مدرن ویندوز (۶۴ بیتی)}
    \begin{itemize}
        \item \textbf{گردش کار پیشنهادی:} ترکیب \textbf{Ghidra} یا \textbf{IDA Pro} (برای تحلیل استاتیک و دکامپایل) با \textbf{\lr{x64dbg}} (برای تحلیل دینامیک، آنپک کردن و پچ).
        \item \textbf{توضیح:} IDA/Ghidra تصویر بزرگ را ارائه می‌دهند؛ \lr{x64dbg} بهترین ابزار تعاملی رایگان برای مشاهده رفتار واقعی بدافزار در user-mode است.
    \end{itemize}

    \item \textbf{سناریو ۲: توسعه اکسپلویت و آسیب‌پذیری در لینوکس}
    \begin{itemize}
        \item \textbf{گردش کار پیشنهادی:} \textbf{GDB} (اغلب با افزونه‌هایی مانند GEF/PEDA) به همراه \textbf{Binary Ninja} یا \textbf{Radare2} (برای تحلیل استاتیک، یافتن گجت‌های ROP و اسکریپت‌نویسی).
        \item \textbf{توضیح:} GDB ابزار بومی و ضروری برای دیباگینگ در لینوکس است. Binja و R2 قابلیت‌های اسکریپت‌نویسی قوی‌تری برای اتوماسیون تحلیل ارائه می‌دهند.
    \end{itemize}

    \item \textbf{سناریو ۳: دیباگینگ درایور یا کرنل ویندوز}
    \begin{itemize}
        \item \textbf{گردش کار پیشنهادی:} \textbf{WinDbg}.
        \item \textbf{توضیح:} این ابزار در این حوزه (دسترسی به کرنل، نمادها و TTD) غیرقابل جایگزین است.
    \end{itemize}

    \item \textbf{سناریو ۴: تحلیل مقیاس‌بزرگ و اتوماسیون (Vulnerability Research)}
    \begin{itemize}
        \item \textbf{گردش کار پیشنهادی:} \textbf{Binary Ninja} یا \textbf{IDA Pro} (با لایسنس‌های headless).
        \item \textbf{توضیح:} تمرکز این سناریو بر API است. API مدرن Binary Ninja و API بالغ IDAPython امکان تحلیل خودکار هزاران باینری را فراهم می‌کنند.
    \end{itemize}

    \item \textbf{سناریو ۵: یادگیری مهندسی معکوس (با بودجه محدود)}
    \begin{itemize}
        \item \textbf{گردش کار پیشنهادی:} \textbf{Ghidra} (برای تحلیل استاتیک و دکامپایل) به همراه \textbf{\lr{x64dbg}} (برای دیباگینگ ویندوز) و \textbf{Cutter (Radare2)} (برای آشنایی با پلتفرم‌های دیگر).
        \item \textbf{توضیح:} این ترکیب ۱۰۰٪ رایگان است و تمام جنبه‌های کلیدی (استاتیک، دکامپایل و دینامیک) را پوشش می‌دهد.
    \end{itemize}
\end{itemize}